% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_pca_loadings.R
\name{plot_pca_loadings}
\alias{plot_pca_loadings}
\title{Plot PCA loadings and mark inflection points}
\usage{
plot_pca_loadings(loadings_df, plot_variables = NULL, spar = 0.999)
}
\arguments{
\item{loadings_df}{A data.frame containing PCA loadings with at least columns
\code{Rank} (numeric loading values) and \code{Variable} (variable/gene identifiers).}

\item{plot_variables}{character() Optional. Vector of variable names to highlight
on the plot with vertical dashed lines and labels. Default: \code{NULL}.}

\item{spar}{numeric Smoothing parameter passed to \code{\link[stats]{smooth.spline}}.
Default is \code{0.999}.}
}
\value{
An integer vector of indices where the second derivative of the spline
  changes sign (the detected inflection points).
}
\description{
Plots PCA loadings ranked in descending order, overlays a smoothed spline, and
identifies inflection points where the second derivative of the spline changes sign.
Optionally highlights specific variables with vertical dashed lines and labels.
}
\examples{
\dontrun{
  df <- data.frame(Variable = paste0("g", 1:100), Rank = sort(rnorm(100), decreasing = TRUE))
  idx <- plot_pca_loadings(df, plot_variables = c("g5", "g20"), spar = 0.9)
}
}
